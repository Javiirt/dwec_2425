<!DOCTYPE html>
<html>

<head>
    <script>

        function ordenarNumeros(valores) { //Función para ordenar un array
            let cambios, posicion1, posicion2;

            do {//Cada vez que se entre al bucle se definen 3 valores por defecto para la ordenación
                cambios = 0;
                posicion1 = 0;
                posicion2 = 1;

                while (posicion2 <= valores.length-1) { //recorremos el array y almacenamos dos valores
                    let valor1 = valores[posicion1];
                    let valor2 = valores[posicion2];

                    if (valor1 > valor2) { //Si el valor anterior es mayor al siguiente, se cambian y aumenta el contador de cambios
                        valores[posicion1] = valor2;
                        valores[posicion2] = valor1;
                        cambios++;
                    }

                    //Aumentamos la posición
                    posicion1++;
                    posicion2++;

                }

            } while (cambios > 0);
            return valores;
        }

        function calcularMedia(valores) {//Función para calcular la media

            let suma = 0;
            for (let i = 0; i < valores.length; i++) {//Recorremos el array y sumamos todos lo valores
                suma += parseFloat(valores[i]);
            }

            let media = suma/valores.length;

            //Mostramos la media
            alert("La media es "+ media);

        }

        function calcularRango(valores) {//Función para calcular el rango
            //Ordenamos los valores para obtener los rangos
            valoresOrdenados = ordenarNumeros(valores);

            if(valoresOrdenados[0]==valoresOrdenados[valoresOrdenados.length-1]){
                alert("El rango es 0");
            }else{
                alert("Los rangos son " + valoresOrdenados[0] + " y "+valoresOrdenados[valoresOrdenados.length-1]);
            }
            
        }


        function calcularModa(valores){//Función para calcular la moda

            //--caso 1 : [3,6,4,7,5,5,9] Moda = 5
            //--caso 2 : [3,6,4,7,5,2,9] Moda = No hay moda
            //--caso 3 : [3,3,4,7,5,5,9] Moda = 3 y 5 (hay valor entre modas)
            //--caso 4 : [3,3,2,7,5,5,9] Moda = 4 (media de 3 y 5, hay solo 2 modas y hay valores ente modas)
            //--caso 5 : [3,3,7,7,5,5,9] Moda = 3, 5, y 7 (hay mas de 3 modas)
            //--caso 6 : [3,3,7,7,5,5] Moda = No hay moda (no hay numero con mayor repeticion)


            //Ordenamos los valores y definimos variables
            let valoresOrdenados = ordenarNumeros(valores);
            let repeticionModa = 0;
            let modas = [];
            let repeticionActual = 0;
            let valorActual;
            let valorAnterior = 0;
            let separacion = false;
            let numeroSeparacion = 0;

            for(let i = 0; i<valores.length ; i++){
                valorActual = valores[i];
                if(i==0){
                    valorAnterior = valorActual;
                }

                if(valorActual==valorAnterior){ 
                    //Si es el mismo numero que el anterior, aumentamos el contador
                    repeticionActual++;                    

                }
                
                if(repeticionActual>repeticionModa){
                    //Si la repetecion actual es mayor a la moda, actualizamos moda
                    modas = [valorAnterior];
                    repeticionModa = repeticionActual;
                    repeticionActual = 1;
                    valorAnterior = valorActual;
                    separacion=false;

                }else if(repeticionActual==repeticionModa){
                    //Si son los mismos valores que la moda, se almacena en valor como moda
                    if(modas.length==1 && valorActual!=numeroSeparacion && numeroSeparacion!=0){//Comprobamos que haya separacion entre modas
                        separacion=true;
                    }
                    modas[modas.length] = valorActual;
                    repeticionActual = 1;
                    valorAnterior = valorActual;

                }else{
                    //Si no es moda, reseteamos el contador
                    numeroSeparacion = valorActual;
                    repeticionActual = 1;
                    valorAnterior = valorActual;
                }
            }



            if(modas.length == 1){
                //Caso 1: solo hay una moda
                alert("La moda es "+modas[0]);

            }else if(modas.length == valores.length){
                //Caso 2: no hay valor que destaque por encima del resto
                alert("No hay ninguna moda");

            }else if(modas.length*repeticionModa == valores.length){
                //Caso 6: no hay valor que destaque por encima del resto
                alert("No hay ninguna moda");

            }else if(modas.length>2){
                //Caso 5: hay más de 3 modas
                let cadena = "Las modas son ";
                for(let i = 0; i<modas.length; i++){
                    if(i == 0){
                        cadena += modas[i];
                    }else if(i<modas.length-1){
                        cadena += ", "+modas[i];
                    }else{
                        cadena += " y "+modas[i];
                    }
                }
                alert(cadena);
            }else if(separacion){
                //Caso 3: hay dos modas separadas por algún valor
                alert("Las modas son "+modas[0]+ " y "+ modas[1]);
            }else if(!separacion){
                //Caso 4: hay dos modas juntas, se hace media
                alert("La moda es "+ (modas[0]+modas[1])/2);
            }else{
                alert(modas);
            }



        }


        (function menu() { //Accedemos a la función menú 
            let contador = 0;
            let valores = [];
            let respuesta ;

            do {//Pedimos que seleccione una opción hasta que elija salir
                respuesta = prompt("Introduzca el valor " + (contador+1) + ". (F para finalizar)");

                if (!isNaN(respuesta) && respuesta!="" && respuesta!=null) {//Añadimos el valor al array si es válido
                    valores[contador] = parseFloat(respuesta);
                    contador++;
                } else if (respuesta != "F" && respuesta != "f" && respuesta!=null) {
                    alert("Debes introducir un valor válido");
                }

            } while (respuesta != "F" && respuesta != "f" && respuesta != null);//Cuando introduzca F sale


            if (valores.length > 1 && respuesta != null) {      

                //Calculamos la media
                calcularMedia(valores);

                //Calculamos el rango
                calcularRango(valores);

                //Calculamos la moda
                calcularModa(valores);
            } else if(respuesta != null){
                alert("Debes introducir mínimo 2 valores para calcular la media, rango y moda.");
            }



        })();

    </script>


</head>

<body>
</body>

</html>